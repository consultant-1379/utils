from selenium import webdriverfrom selenium.webdriver.common.keys import Keysfrom PIL import Imageimport timeimport os#import keyboardglobal_filter = '/html/body/div[2]/div/div/div[1]/div[4]/div/div[1]/div/div[2]/div/div[3]/div[3]/div[1]/div[2]'eniq1_bugs ='/html/body/div[2]/div/div/div[1]/div[4]/div/div[1]/div/div[2]/div/div[3]/div[3]/div[2]/div/div[18]/span[1]/span[1]'eniq2_bugs = '/html/body/div[2]/div/div/div[1]/div[4]/div/div[1]/div/div[2]/div/div[3]/div[3]/div[2]/div/div[19]/span[1]/span[1]'eniq3_bugs = '/html/body/div[2]/div/div/div[1]/div[4]/div/div[1]/div/div[2]/div/div[3]/div[3]/div[2]/div/div[20]/span[1]/span[1]'inflow = '/html/body/div[2]/div/div/div[1]/div[3]/div/div/div[6]/div[1]/div/button[1]'turnaround = '/html/body/div[2]/div/div/div[1]/div[3]/div/div/div[6]/div[1]/div/button[6]'period = '/html/body/div[2]/div/div/div[1]/div[4]/div/div[3]/div/div[2]/div/div[1]/div/button/span[1]'weekly = "/html/body/div[2]/div/div/div[1]/div[4]/div/div[3]/div/div[2]/div/div[1]/div/button/span[1]"apply = '/html/body/div[2]/div/div/div[1]/div[4]/div/div[3]/div/div[1]/button[1]/span'path = "H:/Downloads/"def save_image(name):        scr = driver.find_element_by_xpath('/html/body/div[2]/div/div')        scr.click()        sleep(4)        html = driver.find_element_by_tag_name('html')        html.send_keys(Keys.END)        image_path = name+'.png'        screenshot = driver.save_screenshot(image_path)        #crop(path+'name'+'.png')        imageObject  = Image.open(image_path)        if 'bug' in image_path:                cropped = imageObject.crop((300,155,1350,510))        if 'tat' in image_path:                cropped = imageObject.crop((300,190,1350,540))        cropped.save(image_path)def click(xpath):        button_element = driver.find_element_by_xpath(xpath)        button_element.click()def dos(filter, image_name):        click(filter)        sleep(5)        click(inflow)        sleep(5)        click(filter)        sleep(5)        save_image(image_name+'_bugs')        sleep(5)        click(turnaround)        sleep(5)        save_image(image_name+'_tat')        sleep(5)def sleep(sec):        time.sleep(sec)def copy_to_vobs(png_name):        png_name = "\\"+png_name;        command = "pscp.exe -pw Naples!0512 H:\Downloads"+png_name+" esjkadm100@fem7s11-eiffel013.eiffel.gic.ericsson.se:/proj/eiffel013_config_fem7s11/eiffel_home/slaves/ComputeFarm1/workspace/Weekly_BUG_Report"        os.system(command)options = webdriver.ChromeOptions()options.add_argument("--start-maximized")driver = webdriver.Chrome('H:\Downloads\chromedriver_win32\chromedriver.exe', options=options)driver.get('https://pdu-oss-tools1.seli.wh.rnd.internal.ericsson.com/jirabugtracker/#jirabugtracker')driver.implicitly_wait(10)sleep(3)user = driver.find_element_by_xpath('//*[@id="container"]/div/div/div[3]/form/div/input')user.send_keys('zhshees')sleep(3)password = driver.find_element_by_xpath('//*[@id="container"]/div/div/div[3]/form/div/div[1]/input')password.send_keys('CaspoO2525@1')#keyboard.press_and_release('shift+s,h,i,n,e,shift+4,0,8,0,8')sleep(3)button = driver.find_element_by_xpath('//*[@id="container"]/div/div/div[3]/form/div/div[1]/button')button.click()sleep(5)click(global_filter)sleep(5)click(eniq1_bugs)sleep(5)# scr = driver.find_element_by_xpath('/html/body/div[2]/div/div/div[1]/div[4]/div/div[3]/div/div[2]/div/div[1]/div[1]/div[2]/div[1]/div')# scr.click()# html = driver.find_element_by_tag_name('html')# html.send_keys(Keys.END)sleep(5)save_image('eniq1_bugs')sleep(5)click(turnaround)sleep(5)click(period)sleep(5)click(weekly)sleep(5)click(apply)sleep(5)save_image('eniq1_tat')sleep(5)dos(eniq2_bugs,'eniq2')dos(eniq3_bugs,'eniq3')driver.quit()copy_to_vobs('eniq1_bugs.png')copy_to_vobs('eniq1_tat.png')copy_to_vobs('eniq2_bugs.png')copy_to_vobs('eniq2_tat.png')copy_to_vobs('eniq3_bugs.png')copy_to_vobs('eniq3_tat.png')